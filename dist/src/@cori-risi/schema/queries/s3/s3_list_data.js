"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const type_1 = require("graphql/type");
const definition_1 = require("graphql/type/definition");
const types_1 = require("../../types");
const S3ListData_1 = require("./S3ListData");
const s3_list_data = {
    type: new type_1.GraphQLObjectType({
        name: 'S3ListData',
        fields: () => ({
            list: { type: new definition_1.GraphQLNonNull(new definition_1.GraphQLList(new definition_1.GraphQLNonNull(types_1.JSONObject))) },
            test: { type: types_1.JSONObject }, // <-- object containing results of all tests
            // <-- run by the resolver stored as:
            // <-- { "test description": true | false }
            type: { type: type_1.GraphQLString }
        })
    }),
    args: {
        bucket: {
            type: type_1.GraphQLString //new GraphQLList(GraphQLString)!,
        },
        container_name: {
            type: type_1.GraphQLString
        }
    },
    resolve: async (_, { bucket, container_name }, { dataSources: { restApi, s3DataSource } }, info) => {
        console.log("Resolve S3ListData...", {
            restApi,
            s3DataSource
        });
        // return ({
        //     "type": "s3_list_data",
        //     "list": [],
        //     "test": test
        // });
        const Bucket = (!!bucket && bucket.length > 0) ?
            "cori-risi-apps" :
            bucket;
        return (!!container_name && container_name.length > 0) ?
            (await (0, S3ListData_1.default)(Bucket, container_name)) :
            (await (0, S3ListData_1.default)(Bucket));
    }
};
exports.default = s3_list_data;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiczNfbGlzdF9kYXRhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL0Bjb3JpLXJpc2kvc2NoZW1hL3F1ZXJpZXMvczMvczNfbGlzdF9kYXRhLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsdUNBQXlHO0FBQ3pHLHdEQUF5RjtBQUN6Rix1Q0FBeUM7QUFDekMsNkNBQXNDO0FBRXRDLE1BQU0sWUFBWSxHQUFHO0lBQ2pCLElBQUksRUFBRSxJQUFJLHdCQUFpQixDQUFDO1FBQ3hCLElBQUksRUFBRSxZQUFZO1FBQ2xCLE1BQU0sRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ1gsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksMkJBQU8sQ0FBQyxJQUFJLHdCQUFJLENBQUMsSUFBSSwyQkFBTyxDQUFDLGtCQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDOUQsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLGtCQUFVLEVBQUUsRUFBRSw2Q0FBNkM7WUFDN0MscUNBQXFDO1lBQ3JDLDJDQUEyQztZQUN2RSxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsb0JBQWEsRUFBRTtTQUNoQyxDQUFDO0tBQ0wsQ0FBQztJQUNGLElBQUksRUFBRTtRQUNGLE1BQU0sRUFBRTtZQUNKLElBQUksRUFBRSxvQkFBYSxDQUFDLGtDQUFrQztTQUN6RDtRQUNELGNBQWMsRUFBRTtZQUNaLElBQUksRUFBRSxvQkFBYTtTQUN0QjtLQUNKO0lBQ0QsT0FBTyxFQUFFLEtBQUssRUFDWixDQUFNLEVBQ04sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUd2QixFQUNELEVBQ0ksV0FBVyxFQUFFLEVBQ1QsT0FBTyxFQUNQLFlBQVksRUFDZixFQUNDLEVBQ04sSUFBUyxFQUNULEVBQUU7UUFFQSxPQUFPLENBQUMsR0FBRyxDQUFDLHVCQUF1QixFQUFFO1lBQ2pDLE9BQU87WUFDUCxZQUFZO1NBQ2YsQ0FBQyxDQUFDO1FBRUgsWUFBWTtRQUNaLDhCQUE4QjtRQUM5QixrQkFBa0I7UUFDbEIsbUJBQW1CO1FBQ25CLE1BQU07UUFFTixNQUFNLE1BQU0sR0FBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQSxDQUFDO1lBQzlDLGdCQUFnQixDQUFDLENBQUM7WUFDbEIsTUFBTSxDQUFDO1FBRVQsT0FBTyxDQUFDLENBQUMsQ0FBQyxjQUFjLElBQUksY0FBYyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQSxDQUFDO1lBQ3JELENBQUMsTUFBTSxJQUFBLG9CQUFVLEVBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QyxDQUFDLE1BQU0sSUFBQSxvQkFBVSxFQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFFakMsQ0FBQztDQUNKLENBQUM7QUFFRixrQkFBZSxZQUFZLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBHcmFwaFFMQm9vbGVhbiwgR3JhcGhRTEludCwgR3JhcGhRTExpc3QsIEdyYXBoUUxPYmplY3RUeXBlLCBHcmFwaFFMU3RyaW5nIH0gZnJvbSBcImdyYXBocWwvdHlwZVwiO1xuaW1wb3J0IHsgR3JhcGhRTExpc3QgYXMgTGlzdCwgR3JhcGhRTE5vbk51bGwgYXMgTm9uTnVsbCB9IGZyb20gXCJncmFwaHFsL3R5cGUvZGVmaW5pdGlvblwiO1xuaW1wb3J0IHsgSlNPTk9iamVjdCB9IGZyb20gXCIuLi8uLi90eXBlc1wiO1xuaW1wb3J0IFMzTGlzdERhdGEgZnJvbSBcIi4vUzNMaXN0RGF0YVwiO1xuXG5jb25zdCBzM19saXN0X2RhdGEgPSB7XG4gICAgdHlwZTogbmV3IEdyYXBoUUxPYmplY3RUeXBlKHtcbiAgICAgICAgbmFtZTogJ1MzTGlzdERhdGEnLFxuICAgICAgICBmaWVsZHM6ICgpID0+ICh7XG4gICAgICAgICAgICBsaXN0OiB7IHR5cGU6IG5ldyBOb25OdWxsKG5ldyBMaXN0KG5ldyBOb25OdWxsKEpTT05PYmplY3QpKSkgfSxcbiAgICAgICAgICAgIHRlc3Q6IHsgdHlwZTogSlNPTk9iamVjdCB9LCAvLyA8LS0gb2JqZWN0IGNvbnRhaW5pbmcgcmVzdWx0cyBvZiBhbGwgdGVzdHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA8LS0gcnVuIGJ5IHRoZSByZXNvbHZlciBzdG9yZWQgYXM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gPC0tIHsgXCJ0ZXN0IGRlc2NyaXB0aW9uXCI6IHRydWUgfCBmYWxzZSB9XG4gICAgICAgICAgICB0eXBlOiB7IHR5cGU6IEdyYXBoUUxTdHJpbmcgfVxuICAgICAgICB9KVxuICAgIH0pLFxuICAgIGFyZ3M6IHtcbiAgICAgICAgYnVja2V0OiB7XG4gICAgICAgICAgICB0eXBlOiBHcmFwaFFMU3RyaW5nIC8vbmV3IEdyYXBoUUxMaXN0KEdyYXBoUUxTdHJpbmcpISxcbiAgICAgICAgfSxcbiAgICAgICAgY29udGFpbmVyX25hbWU6IHtcbiAgICAgICAgICAgIHR5cGU6IEdyYXBoUUxTdHJpbmdcbiAgICAgICAgfVxuICAgIH0sXG4gICAgcmVzb2x2ZTogYXN5bmMgKFxuICAgICAgXzogYW55LFxuICAgICAgeyBidWNrZXQsIGNvbnRhaW5lcl9uYW1lIH06IHtcbiAgICAgICAgICBidWNrZXQ6IHN0cmluZyxcbiAgICAgICAgICBjb250YWluZXJfbmFtZTogc3RyaW5nXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAgIGRhdGFTb3VyY2VzOiB7XG4gICAgICAgICAgICAgIHJlc3RBcGksXG4gICAgICAgICAgICAgIHMzRGF0YVNvdXJjZVxuICAgICAgICAgIH1cbiAgICAgIH06IGFueSxcbiAgICAgIGluZm86IGFueVxuICAgICkgPT4gIHtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIlJlc29sdmUgUzNMaXN0RGF0YS4uLlwiLCB7XG4gICAgICAgICAgICByZXN0QXBpLFxuICAgICAgICAgICAgczNEYXRhU291cmNlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHJldHVybiAoe1xuICAgICAgICAvLyAgICAgXCJ0eXBlXCI6IFwiczNfbGlzdF9kYXRhXCIsXG4gICAgICAgIC8vICAgICBcImxpc3RcIjogW10sXG4gICAgICAgIC8vICAgICBcInRlc3RcIjogdGVzdFxuICAgICAgICAvLyB9KTtcblxuICAgICAgICBjb25zdCBCdWNrZXQgPSAgKCEhYnVja2V0ICYmIGJ1Y2tldC5sZW5ndGggPiAwKT9cbiAgICAgICAgICBcImNvcmktcmlzaS1hcHBzXCIgOlxuICAgICAgICAgIGJ1Y2tldDtcblxuICAgICAgICByZXR1cm4gKCEhY29udGFpbmVyX25hbWUgJiYgY29udGFpbmVyX25hbWUubGVuZ3RoID4gMCk/XG4gICAgICAgICAgKGF3YWl0IFMzTGlzdERhdGEoQnVja2V0LCBjb250YWluZXJfbmFtZSkpIDpcbiAgICAgICAgICAoYXdhaXQgUzNMaXN0RGF0YShCdWNrZXQpKTtcblxuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHMzX2xpc3RfZGF0YTtcbiJdfQ==